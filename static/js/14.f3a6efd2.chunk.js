(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[14],{1004:function(e,t,s){"use strict";var a=s(975),o=s(299),n=s(965),i=s(60),r=s(1085),l=s(974),c=s(0),d=s(87),u=s(66),b=s(298),m=s(40),j=s(302),p=s(67),h=s(292),O=s(5);t.a=Object(u.b)((e=>{var t;const s=e.UserReducer,a=e.TableReduce;return{roles:null===(t=s.userInfo)||void 0===t?void 0:t.roles,tableData:{...a.tableData}}}),(e=>({setTableInfo:(t,s)=>e({type:"setTableInfo",name:t,data:s}),setDataSource:(t,s)=>e({type:"setDataSource",data:t,name:s,add:!1})})))(Object(b.a)()(Object(m.e)((e=>{var t,s;const[u,b]=Object(c.useState)(0),[m,S]=Object(c.useState)(),[g,x]=Object(c.useState)(!0),[y,v]=Object(c.useState)(1),[f,I]=Object(c.useState)(Object(p.a)(e.defaultPageSize,d.h)),[w,T]=Object(c.useState)(),[D,C]=Object(c.useState)(0),R=t=>{S(t),void 0!==e.setDataSource&&void 0!==e.name&&e.setDataSource(t,e.name)},k=(t,s,a,o)=>{var n,i,r,l,c;const d=null===(n=e.tableData[e.name])||void 0===n?void 0:n.tableInfo;var u,m,j,p;void 0!==d&&(void 0===o&&void 0!==d.moreProps&&P.setFieldsValue(d.moreProps),t=null!==(u=t)&&void 0!==u?u:d.pageNow,s=null!==(m=s)&&void 0!==m?m:d.pageSize,a=null!==(j=a)&&void 0!==j?j:d.searchKey,o=null!==(p=o)&&void 0!==p?p:d.moreProps);let h=null!==(i=t)&&void 0!==i?i:y,O=null!==(r=s)&&void 0!==r?r:f,S=null!==(l=a)&&void 0!==l?l:w,g=null!==(c=o)&&void 0!==c?c:P.getFieldsValue();v(h),I(O),T(S),x(!0),e.API({pageNow:h,pageSize:O,searchKey:S,...g}).then((t=>{null===t.rows&&(t.rows=[]),void 0!==e.APIRowsTransForm?R(e.APIRowsTransForm(t.rows)):R(t.rows),void 0!==t.totalNum&&"0"!==t.totalNum?(b(t.totalNum),e.name&&e.setTableInfo(e.name,{total:t.totalNum,pageNow:h,pageSize:O,searchKey:S,moreProps:g})):(b(O*t.totalPage),e.name&&e.setTableInfo(e.name,{total:O*t.totalPage,pageNow:h,pageSize:O,searchKey:S,moreProps:g})),x(!1)}))};Object(c.useEffect)((()=>{P.setFieldsValue(e.initRequestProps),k()}),[e.name]);const[P]=Object(h.a)(),z=()=>{const e=P.getFieldsValue();"{}"!==JSON.stringify(e)&&k(1,f,void 0,e)},A=()=>{var t;const s=P.getFieldsValue();P.resetFields();const a=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableInfo;e.name&&e.setTableInfo(e.name,{total:a.total,pageNow:a.pageNow,pageSize:a.pageSize,searchKey:a.searchKey,moreProps:void 0});const o=P.getFieldsValue();JSON.stringify(s)!==JSON.stringify(o)&&k(1,f,void 0,void 0)};return Object(c.useEffect)((()=>{var t;const s=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableVersion;if(void 0!==s&&D!==s)if(s<0){var a;C(-s),S(null===(a=e.tableData[e.name])||void 0===a?void 0:a.dataSource)}else{C(s);const e=P.getFieldsValue();k(y,f,w,e)}}),[e.tableData,D]),Object(O.jsxs)(O.Fragment,{children:[e.useList&&Object(O.jsx)(a.a,{title:e.title,bordered:!0,size:"default",className:null!==(t=e.cardProps)&&void 0!==t?t:"zeroBodyPaddingLeft",extra:(!0===e.search||void 0!==e.getForm)&&Object(O.jsxs)(O.Fragment,{children:[!0===e.search&&Object(O.jsx)(j.a,{placeholder:e.t("searchUser"),onSearch:e=>{T(e),v(1);const t=P.getFieldsValue();k(1,f,e,t)},enterButton:!0,style:{width:300}},"search"),void 0!==e.getForm&&Object(O.jsxs)(o.a,{form:P,children:[e.getForm(z),e.useFormBtn&&Object(O.jsxs)(n.b,{style:{marginLeft:"30px"},size:20,children:[Object(O.jsx)(i.a,{type:"primary",onClick:z,children:"\u7b5b\u9009"}),Object(O.jsx)(i.a,{htmlType:"button",onClick:A,children:"\u91cd\u7f6e"})]})]})]}),children:Object(O.jsx)(r.b,{grid:e.grid,itemLayout:"vertical",loading:g,size:e.size,dataSource:m,renderItem:e.renderItem,pagination:{onChange:(e,t)=>{k(e,t)},current:y,pageSize:f,total:u,size:"small",hideOnSinglePage:!0,showQuickJumper:!0,showLessItems:!0,showSizeChanger:Object(p.a)(e.showSizeChanger,!0),pageSizeOptions:["5","15","20","50","80"]}})}),!e.useList&&Object(O.jsx)(a.a,{bordered:!1,size:"small",extra:(!0===e.search||void 0!==e.getForm)&&Object(O.jsxs)(O.Fragment,{children:[!0===e.search&&Object(O.jsx)(j.a,{placeholder:"\u641c\u7d22",onSearch:e=>{T(e),v(1),k(1,f,e)},enterButton:!0,style:{width:300}},"search"),void 0!==e.getForm&&Object(O.jsxs)(o.a,{form:P,children:[e.getForm(z),Object(O.jsxs)(n.b,{style:{marginLeft:"30px"},size:20,children:[Object(O.jsx)(i.a,{type:"primary",onClick:z,children:e.t("filtering")}),Object(O.jsx)(i.a,{htmlType:"button",onClick:A,children:e.t("Reset")})]})]})]}),children:Object(O.jsx)(l.a,{rowKey:e.rowKey,loading:g,size:e.size,columns:e.columns,rowSelection:e.rowSelection,dataSource:m,pagination:null!==(s=e.pagination)&&void 0!==s?s:{onChange:(e,t)=>{k(e,t)},current:y,pageSize:f,total:u,hideOnSinglePage:!1,showQuickJumper:!0,showLessItems:!0,showSizeChanger:Object(p.a)(e.showSizeChanger,!0),pageSizeOptions:["5","15","20","50","80"]}})})]})}))))},1019:function(e,t,s){"use strict";var a=s(298),o=s(74),n=s(60),i=s(965),r=s(299),l=s(178),c=s(166),d=s(975),u=s(97),b=s(309),m=s(100),j=s(964),p=s(35),h=s(103),O=s(0),S=s(127),g=s.n(S),x=s(1028),y=s(187),v=s(66),f=s(40),I=s(67),w=s(185),T=s(1031),D=s(5);t.a=Object(v.b)((e=>{var t;const s=e.TableReduce,a=e.UserReducer;return{tableData:s.tableData,roles:null===(t=a.userInfo)||void 0===t?void 0:t.roles,isLogin:a.isLogin}}),(e=>({addTableVersion:t=>e({type:"addTableVersion",name:t}),setSelectedRowKeys:(t,s)=>e({type:"setSelectedRowKeys",data:t,name:s}),setDataSource:(t,s)=>e({type:"setDataSource",data:t,name:s,add:!0}),setTopSubmission:(t,s)=>e({type:"setTopSubmission",submissionID:t,submissionInfo:s}),setSubmissionModalVis:t=>e({type:"setSubmissionModalVis",data:t})})))(Object(a.a)()(Object(f.e)((e=>{var t,s;const[a,S]=Object(O.useState)(!1),[v,f]=Object(O.useState)([]),[C,R]=Object(O.useState)(!1),k=Object(I.a)(null===(t=e.tableData[e.name])||void 0===t?void 0:t.selectedRowKeys,[]),P=Object(I.a)(null===(s=e.tableData[e.name])||void 0===s?void 0:s.dataSource,[]),z=t=>{e.setTopSubmission(t.submissionId,{title:t.problemTitle,TimeLimit:t.timeLimit,MemoryLimit:t.memoryLimit,scoreMod:void 0===t.sumScore?"disable":"show",sumScore:t.sumScore,testcaseMod:"show",QuerySubmissionAPI:e.QuerySubmissionAPI}),e.setSubmissionModalVis(!0)},A=[{title:e.t("results"),dataIndex:"result",key:"result",render:(e,t)=>Object(D.jsx)("div",{style:{cursor:"pointer"},onClick:()=>{z(t)},children:Object(D.jsx)(h.a,{type:"text",caseType:p.b.indexOf(p.c[e]),append:"-2"===e?"("+t.RunningStep+"/"+(t.checkpointNum+t.publicCheckpointNum)+")":""})})},{title:e.t("score"),dataIndex:"score",key:"score",render:(e,t)=>void 0===t.sumScore?e:Math.floor(e/t.sumScore*100)+"%"},{title:e.t("submissionTime"),dataIndex:"submitTime",key:"submitTime",render:e=>Object(D.jsx)(o.a,{title:g()(e).format("YYYY-MM-DD HH:mm:ss"),children:Object(D.jsx)("span",{children:g()(e).fromNow()})})}],F=[{title:"ID",dataIndex:"submissionId",key:"submissionId",render:(e,t)=>Object(D.jsx)(n.a,{type:"link",size:"small",onClick:()=>{z(t)},children:e})},{title:e.t("username"),dataIndex:"username",key:"username"},{title:e.t("problemNo."),dataIndex:"problemCode",key:"problemCode",render:e.problemCodeRender},{title:e.t("problemName"),dataIndex:"problemTitle",key:"problemTitle"},{title:e.t("results"),dataIndex:"result",key:"result",width:170,render:(e,t)=>Object(D.jsx)("div",{style:{cursor:"pointer"},onClick:()=>{z(t)},children:Object(D.jsx)(h.a,{type:"text",caseType:p.b.indexOf(p.c[e]),append:"-2"===e?"("+t.RunningStep+"/"+(t.checkpointNum+t.publicCheckpointNum)+")":""})})},{title:e.t("score"),dataIndex:"score",key:"score",render:(e,t)=>void 0===t.sumScore?e:Math.floor(e/t.sumScore*100)+"%"},{title:e.t("template"),dataIndex:"judgeTemplateTitle",key:"judgeTemplateTitle"},{title:e.t("memoryUsage"),dataIndex:"usedMemory",key:"usedMemory",render:e=>e+" KB"},{title:e.t("timeUsage"),dataIndex:"usedTime",key:"usedTime",render:e=>e+" ms"},{title:e.t("submissionTime"),dataIndex:"submitTime",key:"submitTime",render:e=>Object(D.jsx)(o.a,{title:g()(e).format("YYYY-MM-DD HH:mm:ss"),children:Object(D.jsx)("span",{children:g()(e).fromNow()})})}];return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(d.a,{title:Object(D.jsxs)(i.b,{children:[void 0!==e.title?e.title:e.t("submissionRecord"),Object(D.jsx)(b.a,{open:a,dataHandle:t=>{const s=t[0],a=(t[1],t[2]),o=t[3],n=(t[4],t[5]),i=t[6],r=t[7],l=t[8];let c=P;const d=c.findIndex((e=>e.submissionId===s));if(-1!==d){if(o<0){c[d].result=o.toString(),-1===o&&(c[d].result=n,c[d].score=i,c[d].usedTime=r,c[d].usedMemory=l);let e=0;for(const t of c)parseInt(t.result)<=0&&(e+=1);0===e&&S(!1)}else{let e=0;0===a?e=o+1:1===a&&(e=c[d].checkpointNum+o+1),c[d].RunningStep<e&&(c[d].RunningStep=e,c[d].score+=i)}e.setDataSource(c,e.name)}},queryList:v})]}),style:e.lessInfo?{}:{minWidth:1200},className:e.lessInfo?"smallBodyPadding":"",extra:Object(D.jsxs)(i.b,{children:[!0!==e.lessInfo&&Object(w.a)(e.roles,["admin","superadmin"])&&Object(D.jsx)(y.a,{API:m.a.rejudge,data:k,afterSuccess:()=>{e.addTableVersion(e.name),e.setSelectedRowKeys([],e.name)}}),Object(D.jsx)(n.a,{icon:Object(D.jsx)(j.a,{}),onClick:()=>{R(!0),e.addTableVersion(e.name),u.b.success(e.t("refreshSuccessfully")),setTimeout((()=>{R(!1)}),3e3)},disabled:C,children:e.t("refresh")})]}),actions:e.lessInfo&&e.isLogin?[Object(D.jsx)("div",{children:e.lessInfo&&e.isLogin&&Object(D.jsx)(T.a,{btnProps:{type:"text",block:!0},btnText:e.t("ShowAllInformation"),name:"Pro-SubmissionList-"+e.name,API:e.API,QuerySubmissionAPI:e.QuerySubmissionAPI})})]:void 0,children:Object(D.jsx)(x.a,{disableSelection:e.lessInfo||!Object(w.a)(e.roles,["admin","superadmin"]),defaultPageSize:e.lessInfo?5:void 0,showSizeChanger:!e.lessInfo&&void 0,pagination:!e.lessInfo&&void 0,columns:e.lessInfo?A:F,getForm:!0===e.useForm?t=>Object(D.jsxs)(i.b,{size:30,children:[Object(D.jsx)(r.a.Item,{label:e.t("username"),name:"username",children:Object(D.jsx)(l.a,{onPressEnter:e=>{t()},allowClear:!0})}),Object(D.jsx)(r.a.Item,{label:e.t("problemNo."),name:"problemCode",children:Object(D.jsx)(l.a,{onPressEnter:e=>{t()},allowClear:!0})}),Object(D.jsx)(r.a.Item,{label:e.t("JudgeResult"),name:"judgeResult",children:Object(D.jsx)(c.a,{onChange:t,allowClear:!0,style:{width:200},children:p.a.map((e=>Object(D.jsx)(c.a.Option,{value:parseInt(e),children:Object(D.jsx)(h.a,{type:"text",caseType:p.b.indexOf(p.c[e])})})))})})]}):void 0,name:e.name,size:"small",rowKey:"submissionId",API:t=>{if("problemCode"in t&&!Object(I.c)(t.problemCode)){let e=t.problemCode;1===e.length?(null!==e.match(/^[a-z]$/)&&(e=(e.charCodeAt(0)-"a".charCodeAt(0)+1).toString()),null!==e.match(/^[A-Z]$/)&&(e=(e.charCodeAt(0)-"A".charCodeAt(0)+1).toString())):null!==e.match(/^[0-9]{4}$/)&&(e="SDUOJ-"+e),t.problemCode=e}return e.API(t)},APIRowsTransForm:e=>{Object(I.c)(e)&&(e=[]);let t=[],s=[];for(const a of e)a.judgeResult<=0&&t.push(a.submissionId),s.push({...a,score:a.judgeScore,RunningStep:0,result:a.judgeResult.toString(),sumScore:a.sumScore,submitTime:parseInt(a.gmtCreate)});return 0!==t.length&&(S(!0),f(t)),s}})})})}))))},1026:function(e,t,s){"use strict";var a=s(974),o=s(0),n=s.n(o),i=s(66),r=s(298),l=s(40),c=s(1049),d=s(1432),u=s(1048),b=s(5);t.a=n.a.memo(Object(i.b)((e=>({tableData:{...e.TableReduce.tableData}})),(e=>({setTableInfo:(t,s)=>e({type:"setTableInfo",name:t,data:s}),setDataSource:(t,s)=>e({type:"setDataSource",data:t,name:s,add:!1})})))(Object(r.a)()(Object(l.e)((e=>{const[t,s]=Object(o.useState)([]),[n,i]=Object(o.useState)(!0),[r,l]=Object(o.useState)(0),m=t=>{s(t),void 0!==e.setDataSource&&void 0!==e.name&&e.setDataSource(t,e.name)},j=()=>{i(!0),e.API().then((t=>{null===t&&(t=[]),void 0!==e.APIRowsTransForm?m(e.APIRowsTransForm(t)):m(t),i(!1)}))};Object(o.useEffect)((()=>{j()}),[e.name]),Object(o.useEffect)((()=>{var t;const a=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableVersion;var o;void 0!==a&&r!==a&&(a<0?(l(-a),s(null===(o=e.tableData[e.name])||void 0===o?void 0:o.dataSource)):(l(a),j()))}),[e.tableData,r]);const p=Object(c.c)((()=>Object(b.jsx)(d.a,{style:{cursor:"grab",color:"#999"}}))),h=Object(c.b)((e=>Object(b.jsx)("tr",{...e}))),O=Object(c.a)((e=>Object(b.jsx)("tbody",{...e}))),S=s=>{let{oldIndex:a,newIndex:o}=s;a!==o&&(m(Object(u.a)(t,a,o)),e.afterDrag&&e.afterDrag(t,a,o))},g=[{title:"",dataIndex:"sort",width:50,className:"drag-visable",render:()=>Object(b.jsx)(p,{})}];let x=e.columns;return e.useDrag&&(x=g.concat(x)),Object(b.jsx)(a.a,{...e,rowSelection:e.rowSelection,rowKey:e.rowKey,loading:n,size:e.size,columns:x,dataSource:t,pagination:!1,components:{body:{wrapper:e=>Object(b.jsx)(O,{useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:S,...e}),row:s=>{let{className:a,style:o,...n}=s;const i=t.findIndex((t=>t[e.rowKey]===n["data-row-key"]));return Object(b.jsx)(h,{index:i,...n})}}}})})))),((e,t)=>{var s,a;return e.columns===t.columns&&(null===(s=e.rowSelection)||void 0===s?void 0:s.selectedRowKeys.length)===(null===(a=t.rowSelection)||void 0===a?void 0:a.selectedRowKeys.length)&&e.tableData===t.tableData&&e.updateTrick===t.updateTrick}))},1028:function(e,t,s){"use strict";var a=s(0),o=s(298),n=s(40),i=s(66),r=s(1004),l=s(67),c=s(1026),d=s(5);class u extends a.Component{constructor(){super(...arguments),this.setSelectedRowKeys=e=>{this.props.setSelectedRowKeys(e,this.props.name)}}componentDidMount(){}render(){var e;const t=Object(l.a)(null===(e=this.props.tableData[this.props.name])||void 0===e?void 0:e.selectedRowKeys,[]);let s={selectedRowKeys:t,onChange:e=>{this.setSelectedRowKeys(e)},selections:[{key:"all",text:this.props.t("selectedAll"),onSelect:e=>{let s=e;s=s.concat(t.filter((t=>!e.includes(t)))),this.setSelectedRowKeys(s)}},{key:"clear",text:this.props.t("clear"),onSelect:e=>{let s=t.filter((t=>!e.includes(t)));this.setSelectedRowKeys(s)}},{key:"invert",text:this.props.t("invert"),onSelect:e=>{let s=e.filter((e=>!t.includes(e)));s=s.concat(t.filter((t=>!e.includes(t)))),this.setSelectedRowKeys(s)}}]};return Object(d.jsxs)(d.Fragment,{children:[this.props.uesAlldata&&Object(d.jsx)(c.a,{...this.props,rowSelection:this.props.disableSelection?void 0:s}),!0!==this.props.uesAlldata&&Object(d.jsx)(r.a,{...this.props,rowSelection:this.props.disableSelection?void 0:s})]})}}t.a=Object(i.b)((e=>({tableData:e.TableReduce.tableData})),(e=>({setSelectedRowKeys:(t,s)=>e({type:"setSelectedRowKeys",data:t,name:s})})))(Object(o.a)()(Object(n.e)(u)))},1031:function(e,t,s){"use strict";var a=s(298),o=s(40),n=s(0),i=s(60),r=s(968),l=s(1019),c=s(5);t.a=Object(a.a)()(Object(o.e)((e=>{const[t,s]=Object(n.useState)(!1);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(i.a,{...e.btnProps,onClick:()=>{s(!0)},children:e.btnText}),Object(c.jsx)(r.a,{width:1250,visible:t,footer:!1,onCancel:()=>{s(!1)},children:Object(c.jsx)(l.a,{...e})})]})})))},1362:function(e,t,s){"use strict";s.r(t);var a=s(0),o=s(40),n=s(1019),i=s(100),r=s(60),l=s(87),c=s(5);class d extends a.Component{render(){return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:Object(c.jsx)("div",{style:{textAlign:"left",maxWidth:"1500px",margin:"0 auto"},children:Object(c.jsx)(n.a,{name:"BaseSubmission",useForm:!0,API:i.a.getSubmissionList,QuerySubmissionAPI:e=>i.a.getSubmissionInfo({submissionId:e}),problemCodeRender:e=>{let t=e.split("-");return Object(c.jsxs)(r.a,{type:"text",size:"small",onClick:()=>{this.props.history.push(l.g+"/problem/"+e)},children:[Object(c.jsx)("span",{style:{fontWeight:"bold"},children:t[0]}),"-",Object(c.jsx)("span",{children:t[1]})]})}})})})})}}t.default=Object(o.e)(d)}}]);
//# sourceMappingURL=14.f3a6efd2.chunk.js.map