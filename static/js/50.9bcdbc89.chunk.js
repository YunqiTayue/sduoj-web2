(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[50],{1181:function(e,t,s){"use strict";var i=s(972),r=s(973),a=s(178),c=s(1191),n=s(60),o=s(299),l=s(0),d=s(298),j=s(100),b=s(1368),h=s(5);t.a=Object(d.a)()((e=>{const[t,s]=Object(l.useState)(),d=()=>{j.a.getCaptcha().then((t=>{s(t.captcha),e.setImgId(t.captchaId)}))};Object(l.useEffect)((()=>{d()}),[]);const u=Object(h.jsxs)(i.a,{children:[Object(h.jsx)(r.a,{span:14,children:Object(h.jsx)(a.a,{onChange:t=>{void 0!==e.setCaptcha&&e.setCaptcha(t.target.value)}})}),Object(h.jsx)(r.a,{offset:1,span:8,children:Object(h.jsx)(c.a,{src:t,height:32})}),Object(h.jsx)(r.a,{span:1,children:Object(h.jsx)(n.a,{icon:Object(h.jsx)(b.a,{}),onClick:()=>{d()}})})]});return Object(h.jsx)(h.Fragment,{children:[""].map((()=>void 0!==e.setCaptcha?u:Object(h.jsx)(o.a.Item,{name:"captcha",label:e.t("captcha"),rules:[{required:!0}],children:u})))})}))},1182:function(e,t,s){"use strict";var i=s(299),r=s(178),a=(s(0),s(298)),c=s(100),n=s(5);t.a=Object(a.a)()((e=>Object(n.jsx)(i.a.Item,{name:"username",label:e.t("username"),rules:[{required:!1!==e.editable&&!0!==e.notRequired,message:e.t("usernameEmpty")},t=>{let{getFieldValue:s}=t;return{validator:(t,s)=>!0===e.ExistCheck?c.a.isExist({username:s}).then((e=>!1===e?Promise.resolve():!0===e?Promise.reject("\u7528\u6237\u540d\u5df2\u5b58\u5728"):Promise.reject("\u68c0\u9a8c\u5931\u8d25"))).catch((e=>Promise.reject(e))):Promise.resolve()}}],hasFeedback:!0,children:Object(n.jsx)(r.a,{disabled:!1===e.editable,bordered:e.editable})})))},1183:function(e,t,s){"use strict";var i=s(299),r=s(178),a=s(968),c=s(97),n=s(60),o=s(0),l=s(298),d=s(100),j=s(1181),b=s(5);t.a=Object(l.a)()((e=>{var t;const[s,l]=Object(o.useState)(0),[h,u]=Object(o.useState)(!1),[O,m]=Object(o.useState)(""),[p,x]=Object(o.useState)(""),[f,g]=Object(o.useState)("");return Object(o.useEffect)((()=>{let e=setInterval((()=>{s>0&&l(s-1)}),1e3);return()=>clearInterval(e)})),Object(b.jsxs)(b.Fragment,{children:[!1===e.needVerify&&Object(b.jsx)(i.a.Item,{name:"email",label:e.t("email"),rules:!0!==e.notCheck?[{type:"email",message:e.t("emailError")},{required:!1!==e.editable}]:void 0,hasFeedback:!0,children:Object(b.jsx)(r.a,{disabled:!1===e.editable,bordered:!1!==e.editable})}),!0===e.needVerify&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(a.a,{title:"\u4eba\u673a\u8eab\u4efd\u8ba4\u8bc1",visible:h,maskClosable:!1,destroyOnClose:!0,onOk:()=>{d.a.sendVerificationEmail({email:f,captcha:p,captchaId:O,event:e.emailVerifyType}).then((e=>{c.b.success("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u81f3\u60a8\u7684\u90ae\u7bb1"),l(60),u(!1)}))},onCancel:()=>{u(!1)},children:Object(b.jsx)(j.a,{setImgId:m,setCaptcha:x})}),Object(b.jsx)(i.a.Item,{name:"email",label:null!==(t=e.emailTitle)&&void 0!==t?t:e.t("new email"),rules:[{required:!0},t=>{let{getFieldValue:s}=t;return{validator:(t,s)=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?!1===e.checkExist?Promise.resolve():d.a.isExist({email:s}).then((t=>!1===t?Promise.resolve():!0===t?Promise.reject(e.t("\u90ae\u7bb1\u5df2\u5b58\u5728")):Promise.reject(e.t("\u68c0\u9a8c\u5931\u8d25")))).catch((e=>Promise.reject(e))):Promise.reject(e.t("emailError"))}}],children:Object(b.jsx)(r.a,{disabled:!1===e.editable||s>0,bordered:!1!==e.editable,onPressEnter:e.onPressEnter,addonAfter:Object(b.jsx)(n.a,{type:"text",disabled:0!==s,onClick:()=>{e.getEmail().then((e=>{g(e),u(!0)})).catch((()=>{c.b.error("\u90ae\u7bb1\u4e0d\u5408\u6cd5")}))},children:0!==s?s+"s":e.t("Verify")})})}),Object(b.jsx)(i.a.Item,{name:"emailCode",label:e.t("emailCode"),rules:[{required:!0}],children:Object(b.jsx)(r.a,{onPressEnter:e.onPressEnter})})]})]})}))},1217:function(e,t,s){"use strict";function i(e){let t={},s=e.indexOf("?"),i=e.substr(s+1);if(-1!==s){let e=i.split("&");for(let s of e){let e=s.split("=");t[e[0]]=e[1]}}return t}s.d(t,"a",(function(){return i}))},1310:function(e,t,s){"use strict";t.a=s.p+"static/media/sdu-logo.9fcfaf04.jpg"},1401:function(e,t,s){"use strict";s.r(t);var i=s(0),r=s(97),a=s(241),c=s(1191),n=s(975),o=s(965),l=s(60),d=s(66),j=s(298),b=s(40),h=s(1217),u=s(100),O=s(1310),m=s(1415),p=s(1182),x=s(258),f=s(1183),g=s(292),y=s(5);var v=Object(b.e)((e=>{const[t]=Object(g.a)();Object(i.useEffect)((()=>{void 0!==e.token&&t.setFieldsValue({username:e.username})}),[e,t]);const s=Object(d.c)();return Object(y.jsxs)(m.a,{title:void 0!==e.token?"\u6ce8\u518c\u5e76\u7ed1\u5b9a":"\u7528\u6237\u6ce8\u518c",trigger:e.button,autoFocusFirstInput:!0,modalProps:{maskClosable:!1,destroyOnClose:!0,width:500,okText:"\u63d0\u4ea4"},form:t,onFinish:async t=>void 0!==e.token?(Object.assign(t,{token:e.token}),u.a.thirdPartyRegister(t).then((e=>(s({type:"userLogin"}),s({type:"setUserInfo",data:e}),r.b.success("\u6ce8\u518c\u6210\u529f"),!0)))):u.a.register(t).then((e=>(s({type:"userLogin"}),s({type:"setUserInfo",data:e}),r.b.success("\u6ce8\u518c\u6210\u529f"),!0))),children:[Object(y.jsx)(p.a,{ExistCheck:!0,editable:void 0===e.token}),Object(y.jsx)(x.a,{}),Object(y.jsx)(f.a,{emailVerifyType:void 0!==e.token?"thirdPartyRegisterOrBinding":"register",needVerify:!0,getEmail:()=>t.validateFields(["email"]).then((e=>Promise.resolve(e.email))).catch((()=>Promise.reject()))})]})})),k=s(87);var P=Object(j.a)()(Object(b.e)((e=>{const[t]=Object(g.a)(),s=Object(d.c)();return Object(y.jsxs)(m.a,{title:"\u7ed1\u5b9a\u5df2\u6709\u8d26\u53f7",trigger:e.button,autoFocusFirstInput:!0,modalProps:{maskClosable:!1,destroyOnClose:!0,width:500,okText:"\u63d0\u4ea4"},form:t,onFinish:async t=>(Object.assign(t,{token:e.token}),u.a.thirdPartyBinding(t).then((t=>(s({type:"userLogin"}),s({type:"setUserInfo",data:t}),e.history.push(k.g+"/home"),r.b.success("\u7ed1\u5b9a\u6210\u529f"),!0)))),children:[Object(y.jsx)(p.a,{}),Object(y.jsx)(x.a,{noConfirm:!0})]})})));class C extends i.Component{constructor(e,t){super(e,t),this.state={loading:!0,thirdParty:"",info:"",token:"",sduId:""}}componentDidMount(){const e=Object(h.a)(this.props.location.search);u.a.thirdPartyLogin({thirdParty:e.thirdParty,ticket:e.ticket}).then((e=>{if(r.b.success(this.props.t("certificationSuccess")),null===e.user){let t={loading:!1,thirdParty:e.thirdParty,token:e.token};"SDUCAS"===e.thirdParty&&Object.assign(t,{info:e.sduRealName+" ("+e.sduId+")",sduId:e.sduId}),this.setState(t)}else this.props.history.push(k.g+"/home")}))}render(){return Object(y.jsx)("div",{className:"center",style:{width:450},children:[""].map((()=>!0===this.state.loading?Object(y.jsx)(a.a,{tip:this.props.t("certificationIn..."),children:Object(y.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:Object(y.jsx)("div",{children:Object(y.jsx)(c.a,{width:200,src:O.a,preview:!1})})})}):Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(n.a,{title:Object(y.jsxs)("span",{children:[this.props.t("firstTimeUse"),Object(y.jsx)("span",{style:{fontWeight:"bold"},children:this.state.thirdParty}),this.props.t("login,BindingOperationRequired")]}),children:Object(y.jsxs)(o.b,{direction:"vertical",size:15,children:[Object(y.jsxs)("div",{style:{textAlign:"left"},children:[this.props.t("certificationInformation:"),Object(y.jsx)("span",{style:{fontWeight:"bold"},children:this.state.info})]}),Object(y.jsxs)("div",{style:{textAlign:"left"},children:[this.props.t("statuteOfLimitationsCurrentCertification"),Object(y.jsx)("span",{style:{fontWeight:"bold"},children:this.props.t("5Minutes")}),this.props.t("validWithin")]}),Object(y.jsx)(v,{token:this.state.token,username:this.state.sduId,button:Object(y.jsx)(l.a,{block:!0,type:"primary",children:this.props.t("registerAsANewUserAndBind")})}),Object(y.jsx)(P,{token:this.state.token,button:Object(y.jsx)(l.a,{block:!0,type:"primary",children:this.props.t("bindExistingAccounts")})})]})})})))})}}t.default=Object(d.b)((e=>({})),(e=>({})))(Object(j.a)()(Object(b.e)(C)))}}]);
//# sourceMappingURL=50.9bcdbc89.chunk.js.map